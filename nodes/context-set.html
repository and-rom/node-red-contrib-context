<script type="text/javascript">
    RED.nodes.registerType('context-set', {
        category: 'storage-input',
        color: '#C0DEED',
        defaults: {
            name: { value: '' },
            source: {
                value: 'payload',
                required: true,
                validate: RED.validators.typedInput('sourceType', false)
            },
            sourceType: { value: 'msg' },
            destination: {
                value: '',
                required: true,
                validate: RED.validators.typedInput('str', false)
            },
            destinationType: { value: 'flow' }
        },
        inputs: 1,
        outputs: 0,
        icon: 'font-awesome/fa-database',
        label: function() { return this.name || 'context-set' },
        labelStyle: function() { return this.name ? 'node_label_italic' : '' },
        align: 'right',
        paletteLabel: 'context set',
        oneditprepare: function() {

            $('#node-input-source').typedInput({
                type: 'msg',
                types: ['msg', 'str', 'num', 'bool'],
                typeField: '#node-input-sourceType'
            });

            $('#node-input-destination').typedInput({
                type: 'flow',
                types: ['flow', 'global'],
                typeField: '#node-input-destinationType'
            });

        }
    });
</script>

<script type="text/html" data-template-name="context-set">
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> <span data-i18n="node-red:common.label.name"></span></label>
        <input type="text" id="node-input-name" style="width: calc(100% - 105px)" data-i18n="[placeholder]node-red:common.label.name"/>
    </div>
    <div class="form-row">
        <label for="node-input-source"><i class="fa fa-dot-circle-o"></i> <span data-i18n="context-set.label.source"></span></label>
        <input type="text" id="node-input-source" style="width: calc(100% - 105px)"/>
        <input type="hidden" id="node-input-sourceType"/>
    </div>
    <div class="form-row">
        <label for="node-input-destination"><i class="fa fa-usd"></i> <span data-i18n="context-set.label.destination"></span></label>
        <input type="text" id="node-input-destination" style="width: calc(100% - 105px)" placeholder="{{msg.topic}}"/>
        <input type="hidden" id="node-input-destinationType"/>
    </div>
</script>